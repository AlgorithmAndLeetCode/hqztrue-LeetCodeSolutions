take log in the probability, find shortest path. O(n log n+m).


remark. if we need to output the optimal path, then there could be precision problems.

