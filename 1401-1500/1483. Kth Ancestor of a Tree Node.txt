This is the level ancestor problem. O(n) preprocessing, O(1) query.

