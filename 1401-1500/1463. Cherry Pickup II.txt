DP, O(nm^2).

