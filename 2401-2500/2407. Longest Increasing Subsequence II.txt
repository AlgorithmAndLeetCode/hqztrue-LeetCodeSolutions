DP, use segment tree for dynamic range max. O(n log n).

