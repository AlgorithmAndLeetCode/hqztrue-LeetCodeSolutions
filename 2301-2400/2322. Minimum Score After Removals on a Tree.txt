O(n log^2 U) or O(n log U), using presistent trie and mergable segment tree. divide into several cases. see my article https://leetcode.cn/problems/minimum-score-after-removals-on-a-tree/solution/bi-on2geng-kuai-de-yi-xie-suan-fa-by-hqz-lew0/

